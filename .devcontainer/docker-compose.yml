services:
  # Update this to the name of the service you want to work with in your docker-compose.yml file
  dev:
    build:
      context: web
      target: deps  # ensure we use the 'deps' stage from the Dockerfile
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=development
      - DB_URL=postgresql://${POSTGRES_USER:-walklog}:${POSTGRES_PASSWORD:-walklog}@db:5432/${POSTGRES_DB:-walklog}
    depends_on:
      - db
    working_dir: /workspaces/walklog

    volumes:
      # Update this to wherever you want VS Code to mount the folder of your project
      - ..:/workspaces:cached

    # Overrides default command so things don't shut down after the process ends.
    command: sleep infinity
